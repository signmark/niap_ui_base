# Stories Editor - –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- Stories Editor –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –±–µ–∑ React Query
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω drag-and-drop –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–µ–≤—å—é
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π UI —Å —Å–ª–∞–π–¥–µ—Ä–∞–º–∏
- –ü–æ–∫–∞–∑ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ –°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π –≤–∏–¥–µ–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä SimpleVideoEditor
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ä–æ—É—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤–∏–¥–µ–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤ EnhancedStoryEditor
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω UI –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–∫—Å—Ç–∞

## üîß –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ Stories Editor

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LSP –æ—à–∏–±–æ–∫
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ –≤ SimpleStoryEditor.tsx
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è react-draggable

### 2. –£–ª—É—á—à–µ–Ω–∏–µ UX
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –£–ª—É—á—à–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø—Ä–∏ drag-and-drop
- –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ç–∫—É –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —à—Ä–∏—Ñ—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–Ω–µ–π –∏ –æ–±–≤–æ–¥–∫–∏ —Ç–µ–∫—Å—Ç–∞
- –ü–æ–≤–æ—Ä–æ—Ç —Ç–µ–∫—Å—Ç–∞
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–≤—Å—Ç–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤

## üé• –í–∏–¥–µ–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è Stories

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **Frontend**: React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç VideoStoryEditor
- **Backend**: FFmpeg –¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –≤–∏–¥–µ–æ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: Node.js —Å ffmpeg-fluent
- **–ü—Ä–µ–≤—å—é**: HTML5 video + canvas overlay

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
1. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MP4, MOV, AVI
   - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å timeline
   - –û–±—Ä–µ–∑–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

2. **–ù–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞**
   - Drag-and-drop –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è/–∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
   - –ê–Ω–∏–º–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (fade in/out, slide)
   - –í—ã–±–æ—Ä —à—Ä–∏—Ñ—Ç–∞, —Ä–∞–∑–º–µ—Ä–∞, —Ü–≤–µ—Ç–∞

3. **–≠–∫—Å–ø–æ—Ä—Ç –≤–∏–¥–µ–æ**
   - FFmpeg —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å —Ç–µ–∫—Å—Ç–æ–º
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ S3
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Instagram Stories (9:16, H.264 Main)

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **react-player** - –≤–∏–¥–µ–æ –ø–ª–µ–µ—Ä
- **fabric.js** - canvas –¥–ª—è —Ç–µ–∫—Å—Ç–∞ overlay
- **ffmpeg-fluent** - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
- **react-draggable** - –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

## üñºÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞ –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
1. **HTML Canvas API**
   - –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ –ø–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ PNG/JPG

2. **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**
   - Node.js + Canvas
   - Sharp –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π

### –í–∏–¥–µ–æ
1. **FFmpeg Pipeline**
   ```bash
   ffmpeg -i background.mp4 -vf "drawtext=text='${text}':x=${x}:y=${y}:fontsize=${size}:fontcolor=${color}" output.mp4
   ```

2. **–ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤
   - –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –≤–∏–¥–µ–æ
   - –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –æ—à–∏–±–∫–∏ –≤ Stories Editor
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π VideoStoryEditor
3. –î–æ–±–∞–≤–∏—Ç—å FFmpeg –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–∏–¥–µ–æ —Å —Ç–µ–∫—Å—Ç–æ–º

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –£–ª—É—á—à–∏—Ç—å UX Stories Editor
2. –î–æ–±–∞–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å N8N –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤–∏–¥–µ–æ

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞
2. –®–∞–±–ª–æ–Ω—ã –¥–ª—è Stories
3. –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### FFmpeg —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ FFmpeg –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
RUN apt-get update && apt-get install -y ffmpeg
```

### –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ffmpeg-fluent - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
- fabric.js - canvas –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏
- react-player - –≤–∏–¥–µ–æ –ø–ª–µ–µ—Ä
- canvas - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### API endpoints
- POST /api/stories/video/process - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ —Å —Ç–µ–∫—Å—Ç–æ–º
- POST /api/stories/generate-image - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- POST /api/stories/video/preview - –ø—Ä–µ–≤—å—é –≤–∏–¥–µ–æ —Å —Ç–µ–∫—Å—Ç–æ–º

## üìÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 —á–∞—Å–∞)**: LSP –æ—à–∏–±–∫–∏, –º–µ–ª–∫–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- **–í–∏–¥–µ–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä (4-6 —á–∞—Å–æ–≤)**: –±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞ (2-3 —á–∞—Å–∞)**: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤–∏–¥–µ–æ –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2 —á–∞—Å–∞)**: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏