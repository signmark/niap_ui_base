# Технический долг проекта SMM Manager

Этот файл содержит список выявленных проблем и задач, которые требуют решения в будущем.

## Проблемы с API и интеграциями

### 1. Перевод промтов на английский для генерации изображений

**Описание проблемы:** При создании промта на русском языке функция перевода не работает корректно. В логах не видно ошибок, но перевод не происходит, и изображения генерируются с русским текстом.

**Возможные причины:**
- Ошибка в функции translateToEnglish в server/routes.ts
- Отсутствие ключа API DeepSeek или проблемы с аутентификацией
- Неправильно настроенные запросы к DeepSeek API
- Проблемы с методом translatePrompt в falAiService

**Шаги для решения:**
1. Проверить наличие DeepSeek API ключа
2. Добавить подробное логирование ошибок в функцию translateToEnglish
3. Проверить правильность настройки запросов к DeepSeek API
4. Рассмотреть возможность использования альтернативного сервиса перевода

**Приоритет:** Средний
**Статус:** Ожидает решения

## Проблемы с пользовательским интерфейсом

### 1. Улучшение отображения индикаторов загрузки в компонентах VideoUploader и MediaUploader

**Описание проблемы:** В компонентах загрузки файлов при загрузке отображается текст вместо одного спиннера, что делает интерфейс менее удобным. В мобильной версии это приводит к визуальным проблемам и изменению размера кнопки.

**Шаги для решения:**
1. Модифицировать кнопку в компонентах VideoUploader и MediaUploader, чтобы при загрузке (isUploading === true) отображался только спиннер
2. Обеспечить стабильный размер кнопки при переключении между состояниями загрузки
3. Согласовать поведение между разными загрузчиками для единообразия интерфейса

**Приоритет:** Низкий
**Статус:** Ожидает решения

### 2. Предупреждение о несоответствии типов в интерфейсе

**Описание проблемы:** В консоли есть предупреждение 'Type 'unknown' is not assignable to type 'ReactNode'' в client/src/pages/content/index.tsx.

**Приоритет:** Низкий
**Статус:** Ожидает решения

## Проблемы с безопасностью и типизацией

### 1. Ошибки типизации в server/storage.ts

**Описание проблемы:** Множественные ошибки типизации в server/storage.ts, связанные с несоответствием типов объектов.

**Приоритет:** Низкий
**Статус:** Ожидает решения

### 2. Стандартизация форматов полей (snake_case vs camelCase)

**Описание проблемы:** В проекте не соблюдается единый подход к именованию полей. В разных частях системы используются как snake_case (created_at, is_bookmarked, source_id), так и camelCase (createdAt, isBookmarked, sourceId). Это приводит к необходимости добавлять дополнительные проверки в компонентах при работе с данными.

**Пример проблемы:** Компонент TrendsList получает данные от API, где используется snake_case (created_at), но интерфейс и остальные компоненты ожидают camelCase (createdAt).

**Шаги для решения:**
1. Выбрать единый стандарт для всего проекта (предпочтительно camelCase для клиентского кода)
2. Создать единые преобразователи форматов полей для API-ответов
3. Обновить все интерфейсы и типы для соответствия выбранному стандарту
4. Добавить маппинг на уровне хранилища для преобразования snake_case в camelCase при получении данных из базы

**Приоритет:** Средний
**Статус:** Ожидает решения

## Проблемы с архитектурой и рефакторинг

### 1. Разделение файла server/routes.ts на отдельные модули

**Описание проблемы:** Файл server/routes.ts слишком большой (8000+ строк) и сложный для редактирования и поддержки. Необходимо разбить его на отдельные модульные файлы по функциональности.

**Шаги для решения:**
1. Создать структуру директорий по функциональным областям (api/auth, api/campaigns, api/content и т.д.)
2. Перенести соответствующие маршруты в отдельные файлы
3. Создать основной файл, который будет импортировать и регистрировать все маршруты
4. Обновить документацию по структуре проекта

**Прогресс:**
- Валидационные маршруты уже вынесены в отдельный файл server/api/validation-routes.ts

**Приоритет:** Средний
**Статус:** В процессе (начато 18.03.2025)

## Завершенные задачи

### 1. Управление состоянием промтов в диалоге генерации изображений

**Описание проблемы:** При создании нового контента использовался промт от последнего редактирования.

**Решение:** Изменена логика в ImageGenerationDialog.tsx для корректного сброса состояния и разделения логики для новых и существующих постов.

**Статус:** Завершено (17.03.2025)

### 2. Исправление отображения трендов в TrendsList

**Описание проблемы:** Компонент TrendsList не отображал трендовые темы из-за несоответствия форматов полей - на фронтенде ожидалось поле в формате camelCase (createdAt), в то время как API возвращало данные в формате snake_case (created_at).

**Решение:** 
1. Добавлена поддержка обоих форматов полей в компоненте TrendsList.tsx
2. Реализовано преобразование из snake_case в camelCase при маппинге данных из API
3. Добавлены проверки наличия поля в обоих форматах (например, `trend.created_at || trend.createdAt`)

**Статус:** Завершено (25.03.2025)