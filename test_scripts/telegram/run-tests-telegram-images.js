/**
 * –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏ –≤ Telegram
 * –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ HTML-—Ç–µ–≥–∞–º–∏ –≤ –ø–æ–¥–ø–∏—Å—è—Ö
 * –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø—É–±–ª–∏–∫—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
 * 
 * –ó–∞–ø—É—Å–∫: node run-tests-telegram-images.js
 */
import axios from 'axios';
import { config } from 'dotenv';
import { storage } from './server/storage.js';

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
config();

// API URL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
const API_URL = process.env.API_URL || 'http://localhost:5000';

// ID –∫–∞–º–ø–∞–Ω–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
const CAMPAIGN_ID = process.env.CAMPAIGN_ID || '46868c44-c6a4-4bed-accf-9ad07bba790e';

// –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –∫–∞–º–ø–∞–Ω–∏–∏
let settings = {
  telegram: {
    token: process.env.TELEGRAM_BOT_TOKEN || null,
    chatId: process.env.TELEGRAM_CHAT_ID || null
  }
};

// –¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
const testImages = [
  'https://images.unsplash.com/photo-1504674900247-0877df9cc836', // –ï–¥–∞
  'https://images.unsplash.com/photo-1512621776951-a57141f2eefd', // –û–≤–æ—â–∏
  'https://images.unsplash.com/photo-1498837167922-ddd27525d352', // –§—Ä—É–∫—Ç—ã
  'https://images.unsplash.com/photo-1494390248081-4e521a5940db', // –ó–µ–ª–µ–Ω—å
  'https://images.unsplash.com/photo-1476224203421-9ac39bcb3327'  // –î–µ—Å–µ—Ä—Ç
];

// –¢–µ—Å—Ç–æ–≤—ã–µ –∫–µ–π—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
const testCases = [
  {
    name: '1. –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –±–∞–∑–æ–≤—ã–º HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ –ø–æ–¥–ø–∏—Å–∏',
    images: [testImages[0]],
    caption: `<b>–¢–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–¥–ø–∏—Å—å—é</b>

<i>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞</i>

‚Ä¢ <u>–ü—É–Ω–∫—Ç 1</u>
‚Ä¢ <b>–ü—É–Ω–∫—Ç 2</b>
‚Ä¢ <i>–ü—É–Ω–∫—Ç 3</i>

#—Ç–µ—Å—Ç #–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ #—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ`
  },
  {
    name: '2. –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ HTML-—Ç–µ–≥–∞–º–∏ –≤ –ø–æ–¥–ø–∏—Å–∏',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ–≥–æ–≤ –≤ –ø–æ–¥–ø–∏—Å–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é',
    images: [testImages[1]],
    caption: `<b>–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å <i>–≤–ª–æ–∂–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

<u>–ù–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è

‚Ä¢ <b>–ñ–∏—Ä–Ω—ã–π –ø—É–Ω–∫—Ç —Å–ø–∏—Å–∫–∞
‚Ä¢ <i>–ö—É—Ä—Å–∏–≤–Ω—ã–π –ø—É–Ω–∫—Ç

#—Ç–µ—Å—Ç #–Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ #—Ç–µ–≥–∏`
  },
  {
    name: '3. –ì—Ä—É–ø–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ –ø–æ–¥–ø–∏—Å–∏',
    images: [testImages[2], testImages[3], testImages[4]],
    caption: `<b>–ì—Ä—É–ø–ø–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</b>

<i>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–¥–ø–∏—Å—å—é</i>

‚Ä¢ <u>–ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</u>
‚Ä¢ <b>–í—Ç–æ—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</b>
‚Ä¢ <i>–¢—Ä–µ—Ç—å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</i>

<a href="https://example.com">–°—Å—ã–ª–∫–∞ –≤ –ø–æ–¥–ø–∏—Å–∏</a>

#—Ç–µ—Å—Ç #–≥—Ä—É–ø–ø–∞ #–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è`
  },
  {
    name: '4. –ì—Ä—É–ø–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ HTML-—Ç–µ–≥–∞–º–∏ –≤ –ø–æ–¥–ø–∏—Å–∏',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ–≥–æ–≤ –≤ –ø–æ–¥–ø–∏—Å–∏ –∫ –≥—Ä—É–ø–ø–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π',
    images: [testImages[0], testImages[1]],
    caption: `<b>–ì—Ä—É–ø–ø–∞ —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ <i>—Ç–µ–≥–∞–º–∏ –≤ –ø–æ–¥–ø–∏—Å–∏

<u>–°–ø–∏—Å–æ–∫ —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ç–µ–≥–∞–º–∏:
‚Ä¢ <b>–ü–µ—Ä–≤—ã–π –ø—É–Ω–∫—Ç —Å <i>–≤–ª–æ–∂–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
‚Ä¢ <u>–í—Ç–æ—Ä–æ–π –ø—É–Ω–∫—Ç

#—Ç–µ—Å—Ç #–≥—Ä—É–ø–ø–∞ #–Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ #—Ç–µ–≥–∏`
  },
  {
    name: '5. –î–ª–∏–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å—å —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ —Å HTML-—Ç–µ–≥–∞–º–∏',
    images: [testImages[2]],
    caption: `<b>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –¥–ª–∏–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é</b>

<i>–≠—Ç–∞ –ø–æ–¥–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.</i>

${`<u>–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è —Ç–µ–∫—Å—Ç —Å –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º. </u>`.repeat(20)}

<b>–°–ø–∏—Å–æ–∫ –ø—É–Ω–∫—Ç–æ–≤:</b>
‚Ä¢ –ü—É–Ω–∫—Ç 1 —Å <i>–∫—É—Ä—Å–∏–≤–æ–º</i>
‚Ä¢ –ü—É–Ω–∫—Ç 2 —Å <b>–∂–∏—Ä–Ω—ã–º</b>
‚Ä¢ –ü—É–Ω–∫—Ç 3 —Å <u>–ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º</u>
‚Ä¢ –ü—É–Ω–∫—Ç 4 —Å <s>–∑–∞—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º</s>
‚Ä¢ –ü—É–Ω–∫—Ç 5 —Å <code>–º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º</code>

${`<b>–ï—â–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è —Ç–µ–∫—Å—Ç. </b>`.repeat(10)}

#—Ç–µ—Å—Ç #–¥–ª–∏–Ω–Ω–∞—è #–ø–æ–¥–ø–∏—Å—å`
  },
  {
    name: '6. –ú–∞—Ä–∫–¥–∞—É–Ω –≤ –ø–æ–¥–ø–∏—Å–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é',
    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Markdown –≤ HTML –≤ –ø–æ–¥–ø–∏—Å–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é',
    images: [testImages[3]],
    caption: `**–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ markdown**

*–ö—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ markdown*

__–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç –∏–∑ markdown__

~~–ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç –∏–∑ markdown~~

\`–ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ markdown\`

**–ñ–∏—Ä–Ω—ã–π —Å *–≤–ª–æ–∂–µ–Ω–Ω—ã–º –∫—É—Ä—Å–∏–≤–æ–º* –∏–∑ markdown**

#—Ç–µ—Å—Ç #markdown #–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ`
  }
];

/**
 * –ü–æ–ª—É—á–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –∫–∞–º–ø–∞–Ω–∏–∏
 * @returns {Promise<void>}
 */
async function loadSettings() {
  try {
    console.log(`–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –∫–∞–º–ø–∞–Ω–∏–∏ ${CAMPAIGN_ID}...`);
    
    // –ü–æ–ª—É—á–∞–µ–º –∫–∞–º–ø–∞–Ω–∏—é
    const campaign = await storage.getCampaign(CAMPAIGN_ID);
    
    if (!campaign) {
      throw new Error(`–ö–∞–º–ø–∞–Ω–∏—è —Å ID ${CAMPAIGN_ID} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`);
    }
    
    if (!campaign.socialMediaSettings || !campaign.socialMediaSettings.telegram) {
      throw new Error(`–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –∫–∞–º–ø–∞–Ω–∏–∏ ${CAMPAIGN_ID}`);
    }
    
    const telegramSettings = campaign.socialMediaSettings.telegram;
    
    if (!telegramSettings.token || !telegramSettings.chatId) {
      throw new Error(`–ù–µ–ø–æ–ª–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –≤ –∫–∞–º–ø–∞–Ω–∏–∏ ${CAMPAIGN_ID}`);
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    settings.telegram.token = telegramSettings.token;
    settings.telegram.chatId = telegramSettings.chatId;
    
    console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    console.log(`–ö–∞–Ω–∞–ª: ${settings.telegram.chatId}`);
    console.log(`–¢–æ–∫–µ–Ω: ${settings.telegram.token.substring(0, 10)}...`);
    
    return true;
  } catch (error) {
    console.error(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ${error.message}`);
    
    // –ü–æ–ø—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    if (process.env.TELEGRAM_BOT_TOKEN && process.env.TELEGRAM_CHAT_ID) {
      console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è');
      settings.telegram.token = process.env.TELEGRAM_BOT_TOKEN;
      settings.telegram.chatId = process.env.TELEGRAM_CHAT_ID;
      return true;
    }
    
    // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –Ω–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è,
    // –∏—Å–ø–æ–ª—å–∑—É–µ–º –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏');
    settings.telegram.token = '7529101043:AAG298h0iubyeKPuZ-WRtEFbNEnEyqy_XJU';
    settings.telegram.chatId = '-1002302366310';
    return true;
  }
}

/**
 * –ü—É–±–ª–∏–∫—É–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 * @param {object} testCase –¢–µ—Å—Ç–æ–≤—ã–π —Å–ª—É—á–∞–π
 * @param {number} index –ò–Ω–¥–µ–∫—Å —Ç–µ—Å—Ç–∞
 * @returns {Promise<object>} –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
 */
async function runTest(testCase, index) {
  try {
    console.log(`\n----- –¢–µ—Å—Ç ${index+1}/${testCases.length}: ${testCase.name} -----`);
    console.log(`–û–ø–∏—Å–∞–Ω–∏–µ: ${testCase.description}`);
    console.log(`–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${testCase.images.length}`);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ—Å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ –ø–æ–¥–ø–∏—Å–∏
    const testHeader = `üß™ <b>–¢–ï–°–¢ –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô #${index+1}</b>: ${testCase.name}\n\n`;
    const testCaption = testHeader + testCase.caption;
    
    // –°–æ–∑–¥–∞–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
    const requestBody = {
      text: testCaption,
      chatId: settings.telegram.chatId,
      token: settings.telegram.token,
      imageUrl: testCase.images[0],
      additionalImages: testCase.images.slice(1)
    };
    
    // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
    console.log(`–û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ API...`);
    const response = await axios.post(`${API_URL}/api/test/telegram-post`, requestBody);
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç
    if (response.data && response.data.success) {
      const result = response.data.data;
      console.log(`‚úÖ –£–°–ü–ï–•: –¢–µ—Å—Ç #${index+1} –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ!`);
      
      if (result.postUrl) {
        console.log(`üîó URL —Å–æ–æ–±—â–µ–Ω–∏—è: ${result.postUrl}`);
      }
      
      if (result.messageId) {
        console.log(`üìù ID —Å–æ–æ–±—â–µ–Ω–∏—è: ${result.messageId}`);
      }
      
      return { 
        success: true, 
        messageId: result.messageId,
        postUrl: result.postUrl 
      };
    } else {
      console.log(`‚ùå –û–®–ò–ë–ö–ê: –¢–µ—Å—Ç #${index+1} –Ω–µ –ø—Ä–æ–π–¥–µ–Ω!`);
      
      if (response.data && response.data.error) {
        console.log(`–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏: ${response.data.error}`);
      }
      
      console.log(JSON.stringify(response.data, null, 2));
      
      return { 
        success: false, 
        error: response.data?.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞' 
      };
    }
  } catch (error) {
    console.error(`‚ùå –û–®–ò–ë–ö–ê –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞ #${index+1}:`, error.message);
    
    if (error.response) {
      console.error('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', error.response.status);
      console.error('–î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', JSON.stringify(error.response.data, null, 2));
    }
    
    return { 
      success: false, 
      error: error.message 
    };
  }
}

/**
 * –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –∏ –≤—ã–≤–æ–¥–∏—Ç –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
 */
async function runAllTests() {
  console.log('======================================================');
  console.log('üß™ –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í –û–¢–ü–†–ê–í–ö–ò –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –í TELEGRAM');
  console.log('======================================================\n');
  
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  await loadSettings();
  
  // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
  const results = [];
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ
  for (let i = 0; i < testCases.length; i++) {
    const result = await runTest(testCases[i], i);
    results.push(result);
    
    // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã API Telegram
    if (i < testCases.length - 1) {
      console.log('‚è≥ –ü–∞—É–∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Ç–µ—Å—Ç–æ–º...');
      await new Promise(resolve => setTimeout(resolve, 3000));
    }
  }
  
  // –í—ã–≤–æ–¥–∏–º –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  console.log('\n======================================================');
  console.log('üìä –°–í–û–î–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –¢–ï–°–¢–û–í:');
  console.log('======================================================');
  
  // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
  const successCount = results.filter(r => r.success).length;
  
  // –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
  for (let i = 0; i < testCases.length; i++) {
    const status = results[i].success ? '‚úÖ –£–°–ü–ï–•' : '‚ùå –û–®–ò–ë–ö–ê';
    console.log(`${status}: –¢–µ—Å—Ç #${i+1} - ${testCases[i].name}`);
    
    if (!results[i].success && results[i].error) {
      console.log(`   –ü—Ä–∏—á–∏–Ω–∞: ${results[i].error}`);
    }
    
    if (results[i].postUrl) {
      console.log(`   URL: ${results[i].postUrl}`);
    }
  }
  
  // –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  console.log('\n======================================================');
  console.log(`–ò–¢–û–ì–û: ${successCount}/${testCases.length} —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ`);
  
  if (successCount === testCases.length) {
    console.log('‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!');
  } else {
    console.log(`‚ùå ${testCases.length - successCount} –¢–ï–°–¢–û–í –ù–ï –ü–†–û–ô–î–ï–ù–û!`);
  }
  console.log('======================================================');
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã
runAllTests().catch(error => {
  console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤:', error);
  process.exit(1);
});