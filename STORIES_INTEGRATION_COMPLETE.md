# ‚úÖ Stories Integration - –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ:

### 1. Enhanced N8N Workflow
- **–§–∞–π–ª**: `scripts/n8n-stories-workflow-enhanced.json`
- **Webhook URL**: `POST /webhook/publish-stories`
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: Instagram, Facebook, VK, Telegram
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: Polls, Quizzes, Sliders, Questions

### 2. N8N Stories API Integration
- **Backend endpoint**: `/api/n8n/stories/publish`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞**: instagrapi vs –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç Stories

### 3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
const hasInteractive = slides.some(slide => 
  slide.elements?.some(element => 
    ['poll', 'quiz', 'slider', 'question'].includes(element.type)
  )
);

// –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
if (hasInteractive && platform === 'instagram') {
  publishMethod = 'instagrapi'; // –†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
} else {
  publishMethod = 'official_api'; // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π API
}
```

### 4. –ú—É–ª—å—Ç–∏-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
Stories Input ‚Üí Platform Detection ‚Üí [Instagram|Facebook|VK|Telegram] ‚Üí N8N Webhook
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

### –í N8N:
1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `scripts/n8n-stories-workflow-enhanced.json`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PostgreSQL credentials
3. –û–±–Ω–æ–≤–∏—Ç–µ URL endpoints –Ω–∞ –≤–∞—à–∏ —Å–µ—Ä–≤–µ—Ä–∞

### –í —Å–∏—Å—Ç–µ–º–µ:
```javascript
// Stories –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ N8N
const storyData = {
  slides: [{
    elements: [{
      type: 'poll',
      question: '–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ –≤–∞–º –∑–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ?',
      options: ['–î–∞', '–ù–µ—Ç']
    }]
  }]
};

// –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
await publishToN8n(contentId, 'instagram', 'stories', { storyData });
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

### Instagram Stories
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Graph API
- ‚úÖ instagrapi –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏  
- ‚úÖ Polls, Quizzes, Sliders, Questions
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞

### Facebook Stories
- ‚úÖ Graph API Stories
- ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚ö†Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ API

### VK Stories
- ‚úÖ API –ø—É–±–ª–∏–∫–∞—Ü–∏—è
- ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚ö†Ô∏è –ë–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### Telegram Stories  
- ‚úÖ Bot API
- ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚ö†Ô∏è –ë–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

### Poll (–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ)
```json
{
  "type": "poll",
  "question": "–í–∞—à –≤–æ–ø—Ä–æ—Å?",
  "options": ["–í–∞—Ä–∏–∞–Ω—Ç 1", "–í–∞—Ä–∏–∞–Ω—Ç 2"],
  "position": { "x": 50, "y": 80 }
}
```

### Quiz (–í–∏–∫—Ç–æ—Ä–∏–Ω–∞)
```json
{
  "type": "quiz", 
  "question": "–í–æ–ø—Ä–æ—Å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã?",
  "options": ["A", "B", "C", "D"],
  "correct": 0,
  "position": { "x": 50, "y": 70 }
}
```

### Slider (–°–ª–∞–π–¥–µ—Ä)
```json
{
  "type": "slider",
  "question": "–û—Ü–µ–Ω–∏—Ç–µ –æ—Ç 1 –¥–æ 10",
  "emoji": "üî•",
  "position": { "x": 50, "y": 75 }
}
```

### Question (–í–æ–ø—Ä–æ—Å)
```json
{
  "type": "question",
  "text": "–ó–∞–¥–∞–π—Ç–µ –º–Ω–µ –≤–æ–ø—Ä–æ—Å!",
  "position": { "x": 50, "y": 85 }
}
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

### –°—Ç–∞—Ç—É—Å—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ Stories
SELECT 
  id, title, content_type,
  social_platforms->'instagram'->>'status' as instagram_status,
  social_platforms->'instagram'->>'postUrl' as instagram_url
FROM campaign_content 
WHERE content_type = 'stories';
```

### –õ–æ–≥–∏ –≤ N8N execution history –ø–æ–∫–∞–∂—É—Ç:
- –£—Å–ø–µ—à–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Stories
- –û—à–∏–±–∫–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤  
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç:

–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö Stories –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ N8N –Ω–∞ –≤—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚úÖ –†–µ–∞–ª—å–Ω—É—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ Instagram —á–µ—Ä–µ–∑ instagrapi
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é Stories
- ‚úÖ –ü–æ–ª–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!