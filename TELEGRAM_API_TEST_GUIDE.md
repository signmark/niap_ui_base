# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é API –¥–ª—è Telegram HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç API –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è Telegram.

## –¢–µ—Å—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã API

### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤: `http://localhost:3000/api/test`

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```
GET /api/test/status
```

### –ú–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

#### 1. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –¥–ª—è Telegram

```
POST /api/test/telegram/format-html
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `html` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "html": "<p><strong>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</strong> –∏ <em>–∫—É—Ä—Å–∏–≤</em></p>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "originalHtml": "<p><strong>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</strong> –∏ <em>–∫—É—Ä—Å–∏–≤</em></p>",
  "formattedHtml": "<b>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b> –∏ <i>–∫—É—Ä—Å–∏–≤</i>"
}
```

#### 2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –≤ HTML

```
POST /api/test/telegram/format-lists
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `html` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "html": "<ul><li>–ü—É–Ω–∫—Ç 1</li><li>–ü—É–Ω–∫—Ç 2</li></ul>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "originalHtml": "<ul><li>–ü—É–Ω–∫—Ç 1</li><li>–ü—É–Ω–∫—Ç 2</li></ul>",
  "formattedHtml": "‚Ä¢ –ü—É–Ω–∫—Ç 1\n‚Ä¢ –ü—É–Ω–∫—Ç 2",
  "hasBulletPoints": true
}
```

#### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç–º–æ–¥–∑–∏ –≤ HTML

```
POST /api/test/telegram/format-emoji
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `html` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "html": "<p>–ü—Ä–∏–≤–µ—Ç! üëã –≠—Ç–æ —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ üòä</p>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "originalHtml": "<p>–ü—Ä–∏–≤–µ—Ç! üëã –≠—Ç–æ —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ üòä</p>",
  "formattedHtml": "–ü—Ä–∏–≤–µ—Ç! üëã –≠—Ç–æ —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏ üòä",
  "emojiCount": 2,
  "hasEmoji": true
}
```

#### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ–≥–æ–≤ HTML

```
POST /api/test/telegram/fix-unclosed-tags
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `html` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ç–µ–≥–∞–º–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "html": "<p><strong>–ù–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥<em>–í–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥</p>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "originalHtml": "<p><strong>–ù–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥<em>–í–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥</p>",
  "formattedHtml": "<p><strong>–ù–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥<em>–í–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π —Ç–µ–≥</em></strong></p>",
  "tagsBeforeFix": 3,
  "tagsAfterFix": 5,
  "wasFixed": true
}
```

#### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTML (–ø—Ä–æ—Å—Ç–æ–µ –∏–ª–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ)

```
POST /api/test/fix-html
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `text` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `aggressive` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - —Ä–µ–∂–∏–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (true - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π, false - –æ–±—ã—á–Ω—ã–π)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "text": "<p><strong>–¢–µ–≥ –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è</p>",
  "aggressive": true
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "originalText": "<p><strong>–¢–µ–≥ –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è</p>",
  "fixedText": "<strong>–¢–µ–≥ –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è</strong>",
  "aggressive": true
}
```

#### 6. –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ HTML –≤ Telegram

```
POST /api/test/raw-html-telegram
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `text` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- `chatId` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - ID —á–∞—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env)
- `token` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –¢–æ–∫–µ–Ω –±–æ—Ç–∞ Telegram (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ—Ä–µ—Ç—Å—è –∏–∑ .env)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "text": "<b>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b> –∏ <i>–∫—É—Ä—Å–∏–≤</i>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "messageId": 12345,
  "result": { ... } // –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç Telegram API
}
```

#### 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Telegram

```
POST /api/test/telegram-html
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `html` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - HTML-—Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- `chatId` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - ID —á–∞—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- `token` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –¢–æ–∫–µ–Ω –±–æ—Ç–∞ Telegram

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "html": "<p><strong>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</strong> —Å <em>—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º</em></p>"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "formattedHtml": "<b>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</b> —Å <i>—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º</i>",
  "messageId": 12345
}
```

## –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ API

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö API –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```
node telegram-html-test-routes.js
```

–°–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã API –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å.

### 2. –ü—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ HTML –≤ Telegram

–î–ª—è –ø—Ä—è–º–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTML-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```
node telegram-direct-html-test.js
```

–°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ Telegram, –∏—Å–ø–æ–ª—å–∑—É—è bot token –∏ chat ID –∏–∑ —Ñ–∞–π–ª–∞ .env.

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTML –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```
node telegram-integration-test.js
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTML –¥–æ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram, –≤–∫–ª—é—á–∞—è —Ç–µ—Å—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.

## –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã HTML

–†–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã HTML –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `telegram-html-test-cases.js`. –û–Ω–∏ –≤–∫–ª—é—á–∞—é—Ç:

- –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ë–∞–∑–æ–≤—ã–π HTML
- HTML —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±–ª–æ–∫–∞–º–∏
- HTML —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ (–æ–±—ã—á–Ω—ã–º–∏ –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏)
- HTML —Å —ç–º–æ–¥–∑–∏
- HTML —Å —Å—Å—ã–ª–∫–∞–º–∏
- HTML —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ç–µ–≥–∞–º–∏
- HTML —Å –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º–∏ Telegram —Ç–µ–≥–∞–º–∏
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π HTML —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –≤ —Ñ–∞–π–ª–µ `.env` —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

1. –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö API –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTML
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞
3. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ–≥–æ–≤ –∏ –¥—Ä—É–≥–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏
4. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Ç–µ—Å—Ç–∞–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram
5. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Å—Ç–æ–º –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤